/*! Thrive Dashboard - 2019-04-12
* http://www.thrivethemes.com/
* Copyright (c) 2019 Thrive Themes */

var TVD_SS=TVD_SS||{};TVD_SS.util=TVD_SS.util||{},TVD_SS.util.field_types={0:"text",1:"address",2:"phone",3:"email",4:"link",5:"location"},TVD_SS.util.get_field_type_name=function(a){return TVD_SS.util.field_types[a]};var TVD_SS=TVD_SS||{};TVD_SS.models=TVD_SS.models||{},TVD_SS.collections=TVD_SS.collections||{},function(a){TVD_SS.models.Base=Backbone.Model.extend({idAttribute:"ID",toDeepJSON:function(){var b=a.extend(!0,{},this.attributes);return _.each(_.keys(b),function(a){_.isUndefined(b[a])||_.isNull(b[a])||!_.isFunction(b[a].toJSON)||(b[a]=b[a].toJSON())}),b},deepClone:function(){return new this.constructor(this.toDeepJSON())},ensureCollectionData:function(a,b){_.each(b,_.bind(function(b,c){return!a[c]||(this.get(c)instanceof b?(this.get(c).reset(a[c]),void(a[c]=this.get(c))):(a[c]=new b(a[c]),!0))},this))},validation_error:function(a,b){return{field:a,message:b}},sync:function(a,b,c){var d;return c=c||{},c.cache=!1,_.isUndefined(TVD_SS.nonce)||_.isNull(TVD_SS.nonce)||(d=c.beforeSend,c.beforeSend=function(a){if(a.setRequestHeader("X-WP-Nonce",TVD_SS.nonce),d)return d.apply(this,arguments)}),Backbone.sync(a,b,c)}}),TVD_SS.collections.Base=Backbone.Collection.extend({last:function(){return this.at(this.size()-1)},sync:function(a,b,c){var d;return c=c||{},c.cache=!1,_.isUndefined(TVD_SS.nonce)||_.isNull(TVD_SS.nonce)||(d=c.beforeSend,c.beforeSend=function(a){if(a.setRequestHeader("X-WP-Nonce",TVD_SS.nonce),d)return d.apply(this,arguments)}),Backbone.sync(a,b,c)}}),TVD_SS.models.BreadcrumbLink=TVD_SS.models.Base.extend({defaults:{ID:"",hash:"",label:"",full_link:!1},initialize:function(a){this.get("ID")||a.label&&this.set("ID",a.label.split(" ").join("").toLowerCase()),this.set("full_link",a.hash.match(/^http/))},get_url:function(){return this.get("full_link")?this.get("hash"):"#"+this.get("hash")}}),TVD_SS.collections.Breadcrumbs=TVD_SS.collections.Base.extend({model:TVD_SS.models.Base.extend({defaults:{hash:"",label:""}}),add_page:function(a,b){var c=new TVD_SS.models.BreadcrumbLink({hash:a,label:b});return this.add(c)}}),TVD_SS.models.Field=TVD_SS.models.Base.extend({idAttribute:"id",defaults:{group_id:0,name:"",type:0,data:{},icon:"",formated_data:"",is_default:0,opened:!1,created_at:"",updated_at:""},initialize:function(){null===this.get("data")&&this.set({data:{}})},url:function(){var a=TVD_SS.routes.fields;return(this.get("id")||0===this.get("id"))&&(a+="/"+this.get("id")),a},validate:function(a,b){this.errors=[],a.name||this.errors.push(this.validation_error("name",TVD_SS.t.InvalidName));var c=TVE_Dash.upperFirst(TVD_SS.util.get_field_type_name(parseInt(a.type))),d="validate"+c+"Field";if("function"==typeof this[d]&&this[d].call(this,a.data),this.errors.length)return this.errors},validateTextField:function(a){a.text||this.errors.push(this.validation_error("data_text",TVD_SS.t.InvalidText))},validateAddressField:function(a){a.address1||this.errors.push(this.validation_error("data_address1",TVD_SS.t.InvalidAddress)),a.city||this.errors.push(this.validation_error("data_city",TVD_SS.t.InvalidCity)),a.country||this.errors.push(this.validation_error("data_country",TVD_SS.t.InvalidCountry)),a.state||this.errors.push(this.validation_error("data_state",TVD_SS.t.InvalidState)),a.zip||this.errors.push(this.validation_error("data_zip",TVD_SS.t.InvalidZip))},validatePhoneField:function(a){a.phone||this.errors.push(this.validation_error("data_phone",TVD_SS.t.InvalidPhone))},validateEmailField:function(a){if(!a.email)return void this.errors.push(this.validation_error("data_email",TVD_SS.t.NoEmail));/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(a.email)||this.errors.push(this.validation_error("data_email",TVD_SS.t.InvalidEmail))},validateLinkField:function(a){if(a.text||this.errors.push(this.validation_error("data_text",TVD_SS.t.InvalidText)),!a.url)return void this.errors.push(this.validation_error("data_url",TVD_SS.t.NoURL));new RegExp("^((ft|htt)ps?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%@_.~+&:]*)*(\\?[;&a-z\\d%@_.,~+&:=-]*)?(\\#[-a-z\\d_]*)?$","i").test(a.url)||this.errors.push(this.validation_error("data_url",TVD_SS.t.InvalidURL))},validateLocationField:function(a){a.location||this.errors.push(this.validation_error("data_location",TVD_SS.t.InvalidLocation))}}),TVD_SS.collections.Fields=TVD_SS.collections.Base.extend({model:TVD_SS.models.Field}),TVD_SS.models.Group=TVD_SS.models.Base.extend({idAttribute:"id",defaults:{name:"",is_default:0,created_at:"",updated_at:""},initialize:function(){this.set({fields:new TVD_SS.collections.Fields(this.get("fields"))})},url:function(){var a=TVD_SS.routes.groups;return(this.get("id")||0===this.get("id"))&&(a+="/"+this.get("id")),a},validate:function(a,b){var c=[];if(a.name||c.push(this.validation_error("name",TVD_SS.t.InvalidName)),c.length)return c}}),TVD_SS.collections.Groups=TVD_SS.collections.Base.extend({model:TVD_SS.models.Group})}(jQuery);var TVD_SS=TVD_SS||{};TVD_SS.views=TVD_SS.views||{},function(a){a(function(){TVD_SS.views.AddFieldModal=TVE_Dash.views.Modal.extend({template:TVE_Dash.tpl("global-fields/modals/field"),prev_type:null,events:{"click .tvd-modal-close":"close","click .tvd-tss-add-another-field":"addAnotherField","click .tvd-tss-save-field":"save"},afterInitialize:function(a){this.fields=new TVD_SS.collections.Fields(this.model?this.model:""),this.listenTo(this.fields,"add",this.afterRender),this.listenTo(this.fields,"remove",this.afterRender),this.fields.on("add_field",this.addFieldToCollection,this),this.fields.on("render_fields",this.renderFields,this)},afterRender:function(){this.renderFields(),this.renderAddMore()},renderAddMore:function(){new TVD_SS.views.AddMore({el:this.$(".tvd-tss-fields-add-more")[0]}).render()},renderFields:function(){this.$(".tvd-tss-fields-wrapper").empty(),this.fields.each(this.renderField,this),TVE_Dash.materialize(this.$el)},renderField:function(a){this.fields.findWhere({opened:!0})||this.fields.last()!==a||a.set({opened:!0});var b=new TVD_SS.views.ModalFieldData({model:a,group:this.group,collection:this.fields});this.$(".tvd-tss-fields-wrapper").append(b.render().$el)},addFieldToCollection:function(){var a=this.fields.findWhere({opened:!0}),b={opened:!0,data:{}};a&&a.set({opened:!1}),this.group.get("id")&&(b.group_id=this.group.get("id"));var c=new TVD_SS.models.Field(b);this.fields.add(c)},addAnotherField:function(){var a=this.fields.last();a=a.trigger("validate"),0===a.errors.length&&this.addFieldToCollection()},save:function(){if(this.tvd_clear_errors(),!(this.fields.findWhere({opened:!0}).trigger("validate").errors.length>0)){TVE_Dash.showLoader();var b=this;a.ajax({headers:{"X-WP-Nonce":TVD_SS.nonce},type:"POST",url:TVD_SS.routes.fields+"/save_fields/",data:{models:this.fields.toJSON()}}).done(function(a,c,d){a&&b.collection.add(a),TVE_Dash.success(TVD_SS.t.FieldsSaved),b.close()}).error(function(a){var b=JSON.parse(a.responseText);TVE_Dash.err(b.message)}).always(function(){TVE_Dash.hideLoader()})}}}),TVD_SS.views.EditFieldModal=TVE_Dash.views.Modal.extend({template:TVE_Dash.tpl("global-fields/modals/edit-field"),events:{"click .tvd-tss-field-type":"selectType","click .tvd-tss-save-field":"save","input .input-change":"setInputData","click .tvd-modal-close":"close"},afterInitialize:function(a){this.listenTo(this.model,"change:type",this.render)},afterRender:function(){this.renderByType()},selectType:function(b){this.model.set({data:{}}),this.model.set({type:a(b.currentTarget).attr("data-id")})},setInputData:function(b){this.tvd_clear_errors();var c=a(b.currentTarget).attr("data-field"),d=c.split("_");1===d.length?this.model.set(d[0],b.currentTarget.value):d.length>1&&(this.model.get(d[0])[d[1]]=b.currentTarget.value)},renderByType:function(){var a=TVD_SS.util.get_field_type_name(parseInt(this.model.get("type")));if(TVD_SS.views["Field"+TVE_Dash.upperFirst(a)+"Options"]){new(TVD_SS.views["Field"+TVE_Dash.upperFirst(a)+"Options"])({model:this.model,el:this.$(".tvd-tss-field-data-wrapper")[0]}).render(),TVE_Dash.materialize(this.$el)}},save:function(){if(this.tvd_clear_errors(),!this.model.isValid())return this.tvd_show_errors(this.model);var a=this,b=this.model.save();b&&(b.done(function(b,c,d){a.model.trigger("render_field"),a.close(),TVE_Dash.success(TVD_SS.t.FieldSaved)}),b.error(function(a){var b=JSON.parse(a.responseText);TVE_Dash.err(b.message)}),b.always(function(){TVE_Dash.hideLoader()}))}}),TVD_SS.views.GroupModal=TVD_SS.views.AddFieldModal.extend({template:TVE_Dash.tpl("global-fields/modals/group"),events:function(){return _.extend({},TVD_SS.views.AddFieldModal.prototype.events,{"input #tvd-tss-group-name":"setName","click .tvd-tss-add-fields-to-group":"startFields"})},afterInitialize:function(a){TVD_SS.views.AddFieldModal.prototype.afterInitialize.apply(this,arguments)},renderAddMore:function(){this.fields.length>0&&TVD_SS.views.AddFieldModal.prototype.renderAddMore.apply(this,arguments)},renderFields:function(){if(this.$(".tvd-tss-fields-wrapper").empty(),0===this.fields.length){var a=new TVD_SS.views.AddGroupField({});this.$(".tvd-tss-fields-wrapper").append(a.render().$el)}else this.fields.each(this.renderField,this);TVE_Dash.materialize(this.$el)},startFields:function(){this.fields.add(new TVD_SS.models.Field)},setName:function(a){this.group.set({name:a.currentTarget.value})},save:function(){if(this.tvd_clear_errors(),!this.group.isValid())return this.tvd_show_errors(this.group);if(this.fields.length>0){this.group.set({fields:new TVD_SS.collections.Fields(this.fields.toJSON())});if(this.fields.findWhere({opened:!0}).trigger("validate").errors.length>0)return}TVE_Dash.showLoader();var a=this.group.save(),b=this;a&&(a.done(function(a,c,d){b.group.set({fields:new TVD_SS.collections.Fields(b.group.get("fields"))}),b.collection.add(b.group),b.close(),TVE_Dash.success(TVD_SS.t.GroupSaved)}),a.error(function(a){var b=JSON.parse(a.responseText);TVE_Dash.err(b.message)}),a.always(function(){TVE_Dash.hideLoader()}))}}),TVD_SS.views.EditGroupModal=TVE_Dash.views.Modal.extend({template:TVE_Dash.tpl("global-fields/modals/edit-group"),events:{"input #tvd-tss-group-name":"setName","click .tvd-modal-submit":"save"},setName:function(a){this.model.set({name:a.currentTarget.value})},save:function(){if(this.tvd_clear_errors(),!this.model.isValid())return this.tvd_show_errors(this.model);TVE_Dash.showLoader();var a=this.model.get("id"),b=this.model.save(),c=this;b&&(b.done(function(b,d,e){c.model.set({fields:new TVD_SS.collections.Fields(c.model.get("fields"))}),a?c.model.trigger("render_groups"):c.collection.add(c.model),c.close(),TVE_Dash.success(TVD_SS.t.GroupSaved)}),b.error(function(a){var b=JSON.parse(a.responseText);TVE_Dash.err(b.message)}),b.always(function(){TVE_Dash.hideLoader()}))}}),TVD_SS.views.DeleteModal=TVE_Dash.views.Modal.extend({template:TVE_Dash.tpl("global-fields/modals/delete"),events:{"click .tvd-delete-item":"deleteItem"},afterInitialize:function(a){this.$el.addClass("tvd-red");var b=this;_.defer(function(){b.$(".tvd-delete-item").focus()})},deleteItem:function(a){var b=this;TVE_Dash.showLoader();var c=this.model.destroy();c&&(c.done(function(a,c,d){TVE_Dash.success(b.model.get("name")+" "+TVD_SS.t.ItemDeleted)}),c.error(function(a){var b=JSON.parse(a.responseText);TVE_Dash.err(b.message)}),c.always(function(){TVE_Dash.hideLoader(),b.close()}))}})})}(jQuery);var TVD_SS=TVD_SS||{};TVD_SS.views=TVD_SS.views||{},function(a){a(function(){Backbone.View.prototype.tvd_clear_errors=function(){return this.$(".tvd-invalid").removeClass("tvd-invalid"),this.$("select").trigger("tvdclear"),this},Backbone.View.prototype.tvd_show_errors=function(b){function c(b){if("string"==typeof b)return TVE_Dash.err(b);f=f.add(e.$("[data-field="+b.field+"]").addClass("tvd-invalid").each(function(){var c=a(this);c.is("select")?c.trigger("tvderror",b.message):c.next("label").attr("data-error",b.message)}))}if(b=b||this.model){var d=b instanceof Backbone.Model?b.validationError:b,e=this,f=a();return a.isArray(d)?_.each(d,function(a){c(a)}):c(d),f.not(".tvd-no-focus").first().focus(),this.scroll_first_error(f.first()),this}},Backbone.View.prototype.scroll_first_error=function(a){if(!(this instanceof TVE_Dash.views.Modal&&a.length))return this;var b=a.offset().top,c=this.$_content.offset().top,d=this.$_content.scrollTop(),e=this.$_content.outerHeight();if(b>=c&&b<e+c-50)return this;this.$_content.animate({scrollTop:d+b-c-40},200,"swing")},TVD_SS.views.Base=Backbone.View.extend({render:function(){return this},modal:function(a,b){return TVE_Dash.modal(a,b)},bind_zclip:function(){function b(){c.each(function(){var b=a(this),c=b.prev().on("click",function(a){this.select(),a.preventDefault(),a.stopPropagation()}),d=b.attr("data-tvd-btn-color-class")||"tva-copied";try{b.zclip({path:TVE_Dash_Const.dash_url+"/js/util/jquery.zclip.1.1.1/ZeroClipboard.swf",copy:function(){return jQuery(this).prev().val()},afterCopy:function(){var a=jQuery(this);c.select(),a.removeClass(d).addClass("tva-copied"),setTimeout(function(){a.removeClass("tva-copied")},2e3)}})}catch(a){console.error&&console.error("Error embedding zclip - most likely another plugin is messing this up")&&console.error(a)}})}TVE_Dash.bindZClip(this.$el.find("a.tvd-copy-to-clipboard"));var c=this.$el.find(".tva-sendowl-search");setTimeout(b,200)}}),TVD_SS.views.Header=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("header"),render:function(){return this.$el.html(this.template({})),this}}),TVD_SS.views.Menu=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("menu"),render:function(){return this.$el.html(this.template({})),this}}),TVD_SS.views.Breadcrumbs=TVD_SS.views.Base.extend({el:a("#tvd-tss-breadcrumbs-wrapper")[0],template:TVE_Dash.tpl("breadcrumbs"),initialize:function(){this.$title=a("head > title"),this.original_title=this.$title.html(),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"add",this.render)},render:function(){return this.$el.empty().html(this.template({links:this.collection})),this}}),TVD_SS.views.Dashboard=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("dashboard"),render:function(){return this.$el.html(this.template({})),this}}),TVD_SS.views.GlobalFields=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global_fields"),events:{"click .tvd-tss-add-group":"addGroup"},initialize:function(){this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"remove",this.render)},render:function(){return this.$el.html(this.template({})),this.renderSideMenu(),this.renderGroups(),this.$(".tvd-tss-group-item").first().addClass("tvd-active-group"),this},renderSideMenu:function(){new TVD_SS.views.SideMenu({el:this.$(".tvd-tss-side-menu")}).render()},renderGroups:function(){this.collection.each(this.renderGroup,this)},renderGroup:function(a){this.collection.findWhere({expanded:!0})||this.collection.first()!==a||a.set({expanded:!0});var b=new TVD_SS.views.Group({model:a,collection:this.collection});this.$(".tvd-tss-groups-wrapper").append(b.render().$el)},addGroup:function(){this.modal(TVD_SS.views.GroupModal,{collection:this.collection,group:new TVD_SS.models.Group,"max-width":"60%",width:"800px"})}}),TVD_SS.views.SideMenu=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("side-menu"),render:function(){return this.$el.html(this.template({page:Backbone.history.getFragment()})),this}}),TVD_SS.views.Group=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/group"),tagName:"li",className:"tvd-tss-group-item",events:{"click .tvd-tss-add-field":"addField","click .tvd-tss-delete-group":"deleteGroup","click .tvd-tss-edit-group":"editGroup","click .tvd-tss-expand":"expandGroup"},initialize:function(){this.$el.addClass("tvd-tss-group-item-"+this.model.get("id")),this.listenTo(this.model.get("fields"),"add",this.render),this.listenTo(this.model.get("fields"),"remove",this.render),this.listenTo(this.model,"change:expanded",this.render),this.model.on("render_groups",this.render,this),this.$el.on("click",this.activateGroup.bind(this))},activateGroup:function(a){this.$el.closest(".tvd-tss-groups-wrapper").find(".tvd-active-group").removeClass("tvd-active-group"),this.expandGroup(),this.$el.addClass("tvd-active-group")},render:function(){return this.$el.html(this.template({model:this.model})),this.renderFields(),this},expandGroup:function(){var a=this.collection.findWhere({expanded:!0});a&&a.set({expanded:!1}),this.model.set({expanded:!0}),this.render()},renderFields:function(){this.model.get("expanded")&&(0===this.model.get("fields").length?this.$(".tvd-tss-fields-wrapper").html('<p class="tvd-tss-placeholder">'+TVD_SS.t.NoFields+"</p>"):this.model.get("fields").each(this.renderField,this))},renderField:function(a){var b=new TVD_SS.views.Field({model:a,collection:this.model.get("fields"),group:this.model});this.$(".tvd-tss-fields-wrapper").append(b.render().$el)},addField:function(){var a=new TVD_SS.models.Field({group_id:this.model.get("id")});this.modal(TVD_SS.views.AddFieldModal,{model:a,collection:this.model.get("fields"),group:this.model,"max-width":"60%",width:"800px"})},deleteGroup:function(){this.modal(TVD_SS.views.DeleteModal,{model:this.model,collection:this.collection,"max-width":"60%",width:"800px"})},editGroup:function(){this.modal(TVD_SS.views.EditGroupModal,{model:this.model,collection:this.collection,"max-width":"60%",width:"800px"})}}),TVD_SS.views.AddGroupField=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/add-group-field"),className:"tvd-row",render:function(){return this.$el.html(this.template({})),this}}),TVD_SS.views.AddMore=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/add-more"),render:function(){return this.$el.html(this.template({})),this}}),TVD_SS.views.Field=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/field"),tagName:"li",className:"tvd-tss-field-item",events:{"click .tvd-tss-delete-field":"deleteField","click .tvd-tss-edit-field":"editField"},initialize:function(a){this.group=a.group,this.model.on("render_field",this.render,this)},render:function(){return this.$el.html(this.template({model:this.model})),this},deleteField:function(){this.modal(TVD_SS.views.DeleteModal,{model:this.model,collection:this.collection,"max-width":"60%",width:"800px"})},editField:function(){this.modal(TVD_SS.views.EditFieldModal,{model:this.model,collection:this.collection,group:this.group,"max-width":"60%",width:"800px",edit:!0})}}),TVD_SS.views.ModalFieldData=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/field-data"),className:"tvd-new-field-row",events:{"click .tvd-tss-field-type":"selectType","click .tvd-tss-show-field":"showField","click .tvd-tss-delete-field":"deleteField","input .input-change":"setInputData"},initialize:function(a){this.listenTo(this.model,"change:type",this.render),this.model.on("validate",this.validate,this),this.group=a.group},render:function(){return this.$el.html(this.template({model:this.model,group:this.group,collection:this.collection})),this.renderByType(),this.$el.toggleClass("tve-opened-field",this.model.get("opened")),this},showField:function(){if(0===this.collection.last().trigger("validate").errors.length){var a=this.collection.findWhere({opened:!0});a&&a.set({opened:!1}),this.model.set({opened:!0}),this.collection.trigger("render_fields")}},renderByType:function(){var a=TVD_SS.util.get_field_type_name(parseInt(this.model.get("type")));if(TVD_SS.views["Field"+TVE_Dash.upperFirst(a)+"Options"]&&this.model.get("opened")){new(TVD_SS.views["Field"+TVE_Dash.upperFirst(a)+"Options"])({model:this.model,el:this.$(".tvd-tss-field-data-wrapper")[0]}).render(),TVE_Dash.materialize(this.$el)}},deleteField:function(){this.collection.remove(this.model)},selectType:function(b){this.model.set({data:{}}),this.model.set({type:a(b.currentTarget).attr("data-id")})},setInputData:function(b){this.tvd_clear_errors();var c=a(b.currentTarget).attr("data-field"),d=c.split("_");1===d.length?this.model.set(d[0],b.currentTarget.value):d.length>1&&(this.model.get(d[0])[d[1]]=b.currentTarget.value)},validate:function(){return!!this.model.isValid()||this.tvd_show_errors(this.model)}}),TVD_SS.views.FieldTextOptions=TVD_SS.views.Base.extend({template:TVE_Dash.tpl("global-fields/text-options"),render:function(){return this.$el.html(this.template({model:this.model})),this}}),TVD_SS.views.FieldAddressOptions=TVD_SS.views.FieldTextOptions.extend({template:TVE_Dash.tpl("global-fields/address-options")}),TVD_SS.views.FieldPhoneOptions=TVD_SS.views.FieldTextOptions.extend({template:TVE_Dash.tpl("global-fields/phone-options")}),TVD_SS.views.FieldEmailOptions=TVD_SS.views.FieldTextOptions.extend({template:TVE_Dash.tpl("global-fields/email-options")}),TVD_SS.views.FieldLinkOptions=TVD_SS.views.FieldTextOptions.extend({template:TVE_Dash.tpl("global-fields/link-options")}),TVD_SS.views.FieldLocationOptions=TVD_SS.views.FieldTextOptions.extend({template:TVE_Dash.tpl("global-fields/location-options"),events:{"change .input-change":"setInputData"},render:function(){return this.$el.html(this.template({model:this.model})),this.setInputData(),this},setInputData:function(){var a="https://maps.google.com/maps?q="+encodeURI(this.model.get("data").location?this.model.get("data").location:"New York")+"&t=m&z=10&output=embed&iwloc=near";this.$("#tvd-tss-google-map").html('<iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="'+a+'"></iframe>')}})})}(jQuery);var TVD_SS=TVD_SS||{};TVD_SS.globals=TVD_SS.globals||{},function(a){var b=Backbone.Router.extend({$el:a("#tvd-tss-wrapper"),routes:{dashboard:"dashboard",global_fields:"global_fields"},header:null,dashboard_view:null,menu_view:null,sidemenu_view:null,breadcrumbs:{col:null,view:null},set_page:function(b,c,d){this.breadcrumbs.col.reset(),d=d||{},this.breadcrumbs.col.add_page(TVD_SS.dash_url,TVD_SS.t.Thrive_Dashboard,!0),_.each(d,_.bind(function(a){this.breadcrumbs.col.add_page(a.route,a.label)},this)),this.breadcrumbs.col.add_page("",c);var e=a("head > title");this.original_title||(this.original_title=e.html()),e.html(c+" &lsaquo; "+this.original_title)},renderHeader:function(){this.header?this.header.setElement(a("#tvd-tss-header")):this.header=new TVD_SS.views.Header({el:"#tvd-tss-header"}),this.header.render()},init_breadcrumbs:function(){this.breadcrumbs.col=new TVD_SS.collections.Breadcrumbs,this.breadcrumbs.view=new TVD_SS.views.Breadcrumbs({collection:this.breadcrumbs.col})},renderMenu:function(){this.menu_view=new TVD_SS.views.Menu({}),this.$el.find(".tvd-tss-menu").html(this.menu_view.render().$el)},dashboard:function(){this.set_page("","Smart Site",[{route:"dashboard",label:TVD_SS.t.Thrive_Dashboard}]),this.renderHeader(),this.renderMenu(),this.dashboard_view&&this.dashboard_view.remove(),this.dashboard_view=new TVD_SS.views.Dashboard({collection:TVD_SS.globals.groups}),this.$el.find(".tvd-tss-content").html(this.dashboard_view.render().$el),TVE_Dash.materialize(this.$el)},global_fields:function(){this.set_page("","Global Fields",[{route:"dashboard",label:TVD_SS.t.SmartSite},{route:"dashboard",label:TVD_SS.t.Thrive_Dashboard}]),this.renderHeader(),this.renderMenu(),this.dashboard_view&&this.dashboard_view.remove(),this.dashboard_view=new TVD_SS.views.GlobalFields({collection:TVD_SS.globals.groups}),this.$el.find(".tvd-tss-content").html(this.dashboard_view.render().$el),TVE_Dash.materialize(this.$el)}});a(function(){TVD_SS.globals.groups=new TVD_SS.collections.Groups(TVD_SS.data.groups),TVD_SS.router=new b,TVD_SS.router.init_breadcrumbs(),Backbone.history.start({hashchange:!0}),Backbone.history.fragment||TVD_SS.router.navigate("#global_fields",{trigger:!0})})}(jQuery);